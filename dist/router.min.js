/*! ReefRouter v8.2.0 | (c) 2021 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */
var ReefRouter=function(){"use strict";let t,e=/([:*])(\w+)/g,r=/\*/g,n="([^/]+)",o="(?:.*)",i="(?:/$|$)",u="";function c(t){return"/"+function(t){return t.replace(/^(#!)\/?/g,"")}(function(t){return t.replace(/^\/|\/$/g,"")}(t))}function a(a,s){if(!s||"array"!==t.trueTypeOf(s))return[];if("/"===a){let t=function(t){let e=t.find((function(t){return"/"===t.url}));return e?[{route:e,params:{}}]:null}(s);if(t)return t}return s.map((function(t){let s=function(t){let c=[];return{regexp:new RegExp(t.replace(e,(function(t,e,r){return c.push(r),n})).replace(r,o)+i,u),paramNames:c}}(c(t.url)),l=a.replace(/^\/+/,"/").match(s.regexp);if(l)return{route:t,params:function(t,e){return t&&0!==e.length?t.slice(1,t.length).reduce((function(t,r,n){return t[e[n]]=decodeURIComponent(r),t}),{}):{}}(l,s.paramNames)}})).filter((function(t){return t}))}function s(t,e){let r=document.createElement("a");return r.href=(e.length?c(e):"")+c(t),r}function l(e,r,n,o){let i=a(function(t,e,r){let n=c(t.pathname);return e.length?(e=c(e),n.startsWith(e)&&(n=n.slice(e.length)),n.length||(n="/"),n):n}(e=function(t,e,r){return(r&&".html"===t.pathname.slice(-5)||t.hash.startsWith("#!"))&&(t=s(t.hash.slice(2),e)),t}(e,n,o),n),r);if(!i.length)return;let u=t.clone(i[0].route,!0);return u.redirect?l(s("function"==typeof u.redirect?u.redirect(u):u.redirect,n),r,n,o):(u.params=i[0].params,u.search=function(t){let e=new URL(t).searchParams,r={};for(let[t,n]of e)void 0!==r[t]?(Array.isArray(r[t])||(r[t]=[r[t]]),r[t].push(n)):r[t]=n;return r}(e),u)}function f(t){let e=t.split("#");return e[2]?"#"+e[2]:""}function h(t,e){e&&(window.location.hash="!"+cleanURL(e)+t);let r=document.getElementById(t.slice(1));r&&(r.scrollIntoView(),document.activeElement!==r&&(r.setAttribute("tabindex","-1"),r.focus()))}function d(e,r){let n={current:e,next:r};return t.emit(window,"beforeRouteUpdated",n),t.emit(window,"router:before",n)}function p(e,r){let n={current:e,previous:r};return t.emit(window,"routeUpdated",n),t.emit(window,"router:after",n)}function m(t,e){if(!t||!t.title)return;let r="function"==typeof t.title?t.title(t):t.title;document.title="function"==typeof e.title?e.title(t,r):e.title}function w(t,e,r){e._components.forEach((function(t){"render"in t&&t.render()})),m(t,e),r?h(r):function(){let t=document.querySelector("h1, h2, h3, h4, h5, h6");t&&(t.hasAttribute("tabindex")||t.setAttribute("tabindex","-1"),t.focus())}()}function y(t,e){let r=l(t,e.routes,e.root,e.hash);if(r.redirect)return y(getLinkElem("function"==typeof r.redirect?r.redirect(r):r.redirect,e.root),e);if(e.hash){e.hashing=!0;let n=f(t.hash);if(r.url===e.current.url&&n.length)return void h(n,r.url)}let n=e.current;d(n,r),e.current=r;let o=c(t.getAttribute("href"));e.hash?window.location.hash="!"+o:history.pushState(r||{},r&&r.title?r.title:"",o),w(r,e,e.hash?f(t.hash):t.hash),p(r,n)}function g(t,e){if(t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)return;let r=function(t,e){if("closest"in t.target)return t.target.closest("a")}(t);var n;!r||r.host!==window.location.host||r.hasAttribute("download")||"external"===r.getAttribute("rel")||r.href.includes("mailto:")||((n=r).pathname===window.location.pathname&&n.search===window.location.search&&!e.hash&&r.hash.length||(t.preventDefault(),y(r,e)))}function v(t){return function(e){!function(t,e){if(t.state){let r=e.current;d(r,t.state),e.current=t.state,w(e.current,e),p(t.state,r)}else history.replaceState(e.current,document.title,window.location.href)}(e,t)}}function b(t){return function(e){!function(t,e){if(e.hashing)return void(e.hashing=!1);let r=s(window.location.hash.slice(2),e.root),n=(r.getAttribute("href"),l(r,e.routes,e.root,e.hash)),o=e.current;!d(o,n)||(e.current=n,w(n,e),p(n,o))}(0,t)}}let R={routes:[],root:"",title:function(t,e){return e},components:[],useHash:!1};function x(e={}){if(!t||!t.err)throw new Error("Reef not found. Use Reef.use(ReefRouter) to define your global Reef library.");let r=Object.assign({},R,e),n=this,o=r.routes,i=r.useHash||"file:"===window.location.protocol,u=l(window.location,o,r.root,i);var c;n._hashing=!1,Object.defineProperties(n,{routes:{value:t.clone(o,!0)},root:{value:r.root},title:{value:r.title},hash:{value:i},_components:{value:r.components},current:{get:function(){return t.clone(u,!0)},set:function(t){return u=t,!0}},_routes:{set:function(t){return o=t,!0}}}),m(u,n),document.addEventListener("click",(c=n,function(t){g(t,c)})),i?window.addEventListener("hashchange",b(n)):(history.replaceState(u,document.title,window.location.href),window.addEventListener("popstate",v(n))),t.emit(document,"router:initialized",n)}return x.prototype.addRoutes=function(e){let r=t.trueTypeOf(e);if(!["array","object"].includes(r))return t.err("Please provide a valid route or routes.");let n="array"===r?e:[e];for(let t of n)this.routes.push(t);t.emit(document,"router:routes-added",{router:this,routes:n})},x.prototype.removeRoutes=function(e){let r=t.trueTypeOf(e);if(!["array","object"].includes(r))return t.err("Please provide a valid route or routes.");let n="array"===r?e:[e];for(let t of n){let e=this.routes.findIndex((function(e){return e.url===t.url}));if(e<0)return;this.routes.splice(e,1)}t.emit(document,"router:routes-removed",{router:this,routes:n})},x.prototype.addComponent=function(e){let r="array"===type?e:[e];for(let t of r)this._components.push(t);t.emit(document,"router:components-added",{router:this,components:r})},x.prototype.removeComponent=function(e){let r="array"===type?e:[e];for(let t of r){let e=this._components.indexOf(t);if(e<0)return;this._components.splice(e,1)}t.emit(document,"router:components-removed",{router:this,components:r})},x.prototype.visit=function(t){y(s(t,this.root),this)},x.prototype.navigate=x.prototype.visit,x.prototype.updateTitle=function(){m(this.current,this)},x.install=function(e){!function(e){t=e}(e),t.emit(document,"router:ready")},"undefined"!=typeof window&&window.Reef&&window.Reef.use(x),x}();
