/*! Reef v10.0.0 | (c) 2021 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */
var Reef=function(){"use strict";let e=!1;function t(t){e&&console.warn(t)}function n(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function r(e){return["false","null","undefined","0","-0","NaN","0n","-0n"].includes(e)}function o(e,t,n,r){let o;return e&&t?(o=new CustomEvent(t,{bubbles:!0,cancelable:!r,detail:n}),e.dispatchEvent(o)):_.err("You did not provide an element or event name.")}function i(e){function t(t){for(let n in e)e.hasOwnProperty(n)&&(t[n]=i(e[n]))}let r=n(e);return"object"===r?function(){let e={};return t(e),e}():"array"===r?e.map((function(e){return i(e)})):"map"===r?function(){let t=new Map;for(let[n,r]of e)t.set(n,i(r));return t}():"set"===r?function(){let e=new Set;for(let t of set)e.add(i(t));return e}():"function"===r?function(){let n=e.bind(this);return t(n),n}():e}function a(e){e.debounce&&window.cancelAnimationFrame(e.debounce),e.debounce=window.requestAnimationFrame((function(){e.render()}))}function l(e){return{get:function(t,r){return["object","array"].includes(n(t[r]))?new Proxy(t[r],l(e)):t[r]},set:function(t,n,r){return t[n]===r||(t[n]=r,a(e)),!0},deleteProperty:function(t,n){return delete t[n],a(e),!0}}}let c=["input","option","textarea"],u=["value","checked","selected"],d=["checked","selected"];function f(e,t){let n=t.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!n.includes("javascript:")&&!n.includes("data:text/html"))||(!!e.startsWith("on")||void 0)}function s(e,t,n){f(t,n)||(u.includes(t)&&(e[t]="value"===t?n:" "),e.setAttribute(t,n))}function h(e,t){u.includes(t)&&(e[t]=""),e.removeAttribute(t)}function m(e){if(1===e.nodeType){for(let{name:t,value:n}of e.attributes){if(f(t,n)){h(e,t);continue}if("reef-"!==t.slice(0,5))continue;let o=t.replace("reef-default-","").replace("reef-","");h(e,t),d.includes(o)&&r(n)||s(e,o,n)}if(e.childNodes)for(let t of e.childNodes)m(t)}}function p(e){return e.childNodes&&e.childNodes.length?null:e.textContent}function g(e,t){return e.nodeType!==t.nodeType||e.tagName!==t.tagName||e.id!==t.id||e.src!==t.src}function y(e,t,n){let o=e.childNodes,i=t.childNodes;(function(e){let t=e.querySelectorAll("script");for(let e of t)e.remove()})(e)||(o.forEach((function(e,o){if(!i[o])return m(e),void t.append(e.cloneNode(!0));if(g(e,i[o])){let t=function(e,t,n){return Array.from(t).slice(n+1).find((function(t){return!g(e,t)}))}(e,i,o);if(!t)return m(e),void i[o].before(e.cloneNode(!0));i[o].before(t)}if(n.filter((function(t){return![3,8].includes(e.nodeType)&&e.matches(t)})).length>0)return;let a=p(e);if(a&&a!==p(i[o])&&(i[o].textContent=a),function(e,t){if(1!==e.nodeType)return;let n=e.attributes,o=t.attributes;for(let{name:o,value:i}of n){if("reef-default-"===o.slice(0,13))continue;if(u.includes(o)&&c.includes(e.tagName.toLowerCase()))continue;let n=o.replace("reef-","");d.includes(n)&&r(i)?h(t,n):s(t,n,i)}for(let{name:e,value:r}of o)n[e]||u.includes(e)&&c.includes(t.tagName.toLowerCase())||h(t,e)}(e,i[o]),e.childNodes.length||!i[o].childNodes.length){if(!i[o].childNodes.length&&e.childNodes.length){let t=document.createDocumentFragment();return y(e,t,n),void i[o].appendChild(t)}e.childNodes.length&&y(e,i[o],n)}else i[o].innerHTML=""})),function(e,t){let n=e.length-t.length;if(!(n<1))for(;n>0;n--)e[e.length-1].remove()}(i,o))}function v(e,n){if(e)for(let r of e){if(r.attached.includes(n))return t(`"${n.elem}" has attached nodes that it is also attached to, creating an infinite loop.`);"render"in r&&r.render()}}function b(e,r={}){if(!e&&!r.lagoon)return t("You did not provide an element to make into a component.");if(!r.template&&!r.lagoon)return t("You did not provide a template for this component.");let c=this,u=function(e,t){return e.setters?e.store?null:e.data:e.data?new Proxy(e.data,l(t)):null}(r,c),d=r.attachTo?"array"===n(r.attachTo)?r.attachTo:[r.attachTo]:[],{store:f,setters:s,getters:h}=r;c.debounce=null,Object.defineProperties(c,{elem:{value:e},template:{value:r.template},lagoon:{value:r.lagoon},store:{value:f},attached:{value:[]},data:{get:function(){return s?i(u):u},set:function(e){return f||s||(u=new Proxy(e,l(c)),a(c)),!0},configurable:!0},dataCopy:{get:function(){return i(u)}},do:{value:function(e){if(f||!s)return t("There are no setters for this component.");if(!s[e])return t("There is no setter with this name.");let n=Array.from(arguments);n[0]=u,s[e].apply(c,n),a(c)}},get:{value:function(e){if(f||!h)return t("There are no getters for this component.");if(!h[e])return t("There is no getter with this name.");let n=Array.from(arguments);return n[0]=u,h[e].apply(c,n)}}}),f&&"attach"in f&&f.attach(c),d.length&&d.forEach((function(e){"attach"in e&&e.attach(c)})),o(document,"reef:initialized",c)}return b.prototype.render=function(){if(this.lagoon)return void v(this.attached,this);if(!this.template)return t("No template was provided.");let e="string"===n(this.elem)?document.querySelector(this.elem):this.elem;if(!e)return t("The DOM element to render your template into was not found.");let r=Object.assign({},this.store?this.store.data:{},this.data?this.data:{}),i="function"===n(this.template)?this.template(r,e):this.template;if(!o(e,"reef:before-render",r))return;let a=this.attached.map((function(e){return e.elem}));return y(function(e){let t=(new DOMParser).parseFromString(e,"text/html");return t.head&&t.head.childNodes&&t.head.childNodes.length>0&&Array.from(t.head.childNodes).reverse().forEach((function(e){t.body.insertBefore(e,t.body.firstChild)})),t.body||document.createElement("body")}(i),e,a),o(e,"reef:render",r),v(this.attached,this),e},b.prototype.immutableData=function(){return i(this.data)},b.prototype.attach=function(e){let t="array"===n(e)?e:[e];for(let e of t)this.attached.push(e);o(document,"reef:attached",{component:this,attached:t})},b.prototype.detach=function(e){let t="array"===n(e)?e:[e];for(let e of t){let t=this.attached.indexOf(e);if(t<0)return;this.attached.splice(t,1)}o(document,"reef:detached",{component:this,detached:t})},b.Store=function(e){return e.lagoon=!0,new b(null,e)},b.debug=function(t){e=!!t},b.clone=i,b.emit=o,b.err=t,o(document,"reef:ready"),b}();
