/*! Reef v10.0.0 | (c) 2021 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */
var Reef=function(){"use strict";let e=!1;function t(t){e&&console.warn("[Reef] "+t)}function n(e,t={},n=document){let r=new CustomEvent("reef:"+e,{bubbles:!0,cancelable:!0,detail:t});return n.dispatchEvent(r)}function r(e){let t=Object.prototype.toString.call(e).slice(8,-1).toLowerCase();return"object"===t?function(){let t={};for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=r(e[n]));return t}():"array"===t?e.map((function(e){return r(e)})):e}function o(e){let t=e._elem,n=e._store?Object.assign(e._store.data,e.data||{}):e.data;return{elem:t,data:n,template:e._template(n,t)}}function i(e){return["false","null","undefined","0","-0","NaN","0n","-0n"].includes(e)}let l={};var c=function(e){if(l[e.type])for(let t of l[e.type]){let{elem:n,callback:r}=t;(n===e.target||n.contains(e.target))&&r(e)}};function u(e){l[e]&&(delete l[e],document.removeEventListener(e,c,!0))}function a(e,t,n,r){if(!r._listeners)return;let o=t.slice(2),i=r._listeners[n.slice(0,-2)];i&&(!function(e){l[e]||(l[e]=[],document.addEventListener(e,c,!0))}(o),function(e,t,n){return l[e].find((function(e){return t===e.elem&&n===e.callback}))}(o,e,i)||l[o].push({elem:e,callback:i}))}function d(e,t){if(t._listeners)for(let t of e)for(let e in l)l[e]=l[e].filter((function(e){return e.elem!==t})),l[e].length||u(e)}let f=["input","option","textarea"],s=["value","checked","selected"],h=["checked","selected"];function m(e,t){let n=t.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!n.includes("javascript:")&&!n.includes("data:text/html"))||(!!e.startsWith("on")||void 0)}function p(e,t,n){m(t,n)||(s.includes(t)&&(e[t]="value"===t?n:" "),e.setAttribute(t,n))}function v(e,t){s.includes(t)&&(e[t]=""),e.removeAttribute(t)}function b(e,t){if(1===e.nodeType){for(let{name:n,value:r}of e.attributes){if(n.startsWith("on")&&a(e,n,r,t),m(n,r)){v(e,n);continue}if("reef-"!==n.slice(0,5))continue;let o=n.replace("reef-default-","").replace("reef-","");v(e,n),h.includes(o)&&i(r)||p(e,o,r)}if(e.childNodes)for(let n of e.childNodes)b(n,t)}}function g(e){return e.childNodes&&e.childNodes.length?null:e.textContent}function y(e,t){return e.nodeType!==t.nodeType||e.tagName!==t.tagName||e.id!==t.id||e.src!==t.src}function N(e,t,n){let r=e.childNodes,o=t.childNodes;(function(e){let t=e.querySelectorAll("script");for(let e of t)e.remove()})(e)||(r.forEach((function(e,r){if(!o[r]){let r=e.cloneNode(!0);return b(r,n),void t.append(r)}if(y(e,o[r])){let t=function(e,t,n){return Array.from(t).slice(n+1).find((function(t){return!y(e,t)}))}(e,o,r);if(!t){let t=e.cloneNode(!0);return b(t,n),void o[r].before(t)}o[r].before(t)}let l=g(e);if(l&&l!==g(o[r])&&(o[r].textContent=l),function(e,t,n){if(1!==e.nodeType)return;let r=e.attributes,o=t.attributes;for(let{name:o,value:l}of r){if("reef-default-"===o.slice(0,13))continue;if(s.includes(o)&&f.includes(e.tagName.toLowerCase()))continue;let r=o.replace("reef-","");h.includes(r)&&i(l)?v(t,r):o.startsWith("on")?a(t,o,l,n):p(t,r,l)}for(let{name:e,value:n}of o)r[e]||s.includes(e)&&f.includes(t.tagName.toLowerCase())||v(t,e)}(e,o[r],n),!e.childNodes.length&&o[r].childNodes.length)return d(e.children,n),void(o[r].innerHTML="");if(!o[r].childNodes.length&&e.childNodes.length){let t=document.createDocumentFragment();return N(e,t,n),void o[r].appendChild(t)}e.childNodes.length&&N(e,o[r],n)})),function(e,t,n){let r=e.length-t.length;if(!(r<1))for(;r>0;r--)d([e[e.length-1]],n),e[e.length-1].remove()}(o,r,n))}function _(e,o={}){let{data:i,store:l,template:c,isStore:u,setters:a,listeners:d,after:f}=o;if(!e&&!u)return t("Element not found.");if(!c&&!u)return t("Please provide a template function.");let s=r(i);Object.defineProperties(this,{_elem:{get:function(){return"string"==typeof e?document.querySelector(e):e}},_store:{value:l},_template:{value:c},_debounce:{value:!1,writable:!0},_isStore:{value:u},_components:u?{value:[],writable:!0}:{value:null},_listeners:{value:Object.freeze(d)},_after:{value:Object.freeze(f||{})},data:{get:function(){return s}},do:{value:function(e,...n){return a?a[e]?(a[e].apply(this,[s,...n]),i=s,s=r(i),(o=this)._debounce&&window.cancelAnimationFrame(o.debounce),void(o._debounce=window.requestAnimationFrame((function(){o.render()})))):t(`No setter named "${e}".`):t("No setters for this component.");var o}}}),n("initialized",this)}return _.prototype.html=function(){return o(this).template},_.prototype.nest=function(e){let t=this;return e._elem.addEventListener("reef:render",(function(){t.render()}),{once:!0}),""},_.prototype.render=function(){if(this._isStore){for(let e of this._components)"render"in e&&"function"==typeof e.render&&e.render();return}let e=o(this);return e.elem?n("before-render",e.data,e.elem)?(N(function(e){let t=(new DOMParser).parseFromString(e,"text/html");return t.head&&t.head.childNodes&&t.head.childNodes.length>0&&Array.from(t.head.childNodes).reverse().forEach((function(e){t.body.insertBefore(e,t.body.firstChild)})),t.body||document.createElement("body")}(e.template),e.elem,this),this._after.render&&"function"==typeof this._after.render&&this._after.render(this.data),n("render",e.data,e.elem),e.elem):void 0:t("Render target not found.")},_.Store=function(e){return e.isStore=!0,new _(null,e)},_.debug=function(t){e=!!t},_.clone=r,n("ready"),_}();
