/*! Reef v11.0.0 | (c) 2021 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */
var Reef=function(){"use strict";let e=!1;function t(t){e&&console.warn("[Reef] "+t)}function n(e,t={},n=document){let r=new CustomEvent("reef:"+e,{bubbles:!0,cancelable:!0,detail:t});return n.dispatchEvent(r)}function r(e){let t=Object.prototype.toString.call(e).slice(8,-1).toLowerCase();return"object"===t?function(){let t={};for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=r(e[n]));return t}():"array"===t?e.map((function(e){return r(e)})):e}function o(e){e._debounce&&window.cancelAnimationFrame(e.debounce),e._debounce=window.requestAnimationFrame((function(){e.render()}))}function i(e){let t=e.elem,n=r(e._store?Object.assign(e._store.data,e.data||{}):e.data);return{elem:t,data:n,template:e._template(n,t)}}function l(e){return["false","null","undefined","0","-0","NaN","0n","-0n"].includes(e)}function u(e,t){return e?new Proxy(e,function e(t){return{get:function(n,r){return"_isProxy"===r||("object"!=typeof n[r]||n[r]._isProxy||(n[r]=new Proxy(n[r],e(t))),n[r])},set:function(e,n,r){return e[n]===r||(e[n]=r,o(t)),!0},deleteProperty:function(e,n){return delete e[n],o(t),!0}}}(t)):null}let c={};var a=function(e){if(c[e.type])for(let t of c[e.type]){let{elem:n,callback:r}=t;(n===e.target||n.contains(e.target))&&r.call(t.instance,e)}};function s(e){c[e]&&(delete c[e],document.removeEventListener(e,a,!0))}function d(e,t,n,r){if(!r._listeners)return;let o=t.slice(2),i=r._listeners[n.slice(0,-2)];i&&(!function(e){c[e]||(c[e]=[],document.addEventListener(e,a,!0))}(o),function(e,t,n){return c[e].find((function(e){return t===e.elem&&n===e.callback}))}(o,e,i)||c[o].push({elem:e,callback:i,instance:r}))}function f(e,t){if(t._listeners)for(let t of e)for(let e in c)c[e]=c[e].filter((function(e){return e.elem!==t})),c[e].length||s(e)}let h=["input","option","textarea"],m=["value","checked","selected"],p=["checked","selected"];function b(e,t){let n=t.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!n.includes("javascript:")&&!n.includes("data:text/html"))||(!!e.startsWith("on")||void 0)}function v(e,t,n){b(t,n)||(m.includes(t)&&(e[t]="value"===t?n:" "),e.setAttribute(t,n))}function g(e,t){m.includes(t)&&(e[t]=""),e.removeAttribute(t)}function y(e,t){if(1===e.nodeType){for(let{name:n,value:r}of e.attributes){if(n.startsWith("on")&&d(e,n,r,t),b(n,r)){g(e,n);continue}if(!n.startsWith("@")&&!n.startsWith("#"))continue;let o=n.slice(1);g(e,n),p.includes(o)&&l(r)||v(e,o,r)}if(e.childNodes)for(let n of e.childNodes)y(n,t)}}function N(e){return e.childNodes&&e.childNodes.length?null:e.textContent}function _(e,t){return e.nodeType!==t.nodeType||e.tagName!==t.tagName||e.id!==t.id||e.src!==t.src}function w(e,t,n){let r=e.childNodes,o=t.childNodes;(function(e){let t=e.querySelectorAll("script");for(let e of t)e.remove()})(e)||(r.forEach((function(e,r){if(!o[r]){let r=e.cloneNode(!0);return y(r,n),void t.append(r)}if(_(e,o[r])){let t=function(e,t,n){return Array.from(t).slice(n+1).find((function(t){return!_(e,t)}))}(e,o,r);if(!t){let t=e.cloneNode(!0);return y(t,n),void o[r].before(t)}o[r].before(t)}let i=N(e);if(i&&i!==N(o[r])&&(o[r].textContent=i),function(e,t,n){if(1!==e.nodeType)return;let r=e.attributes,o=t.attributes;for(let{name:o,value:i}of r){if(o.startsWith("#"))continue;if(m.includes(o)&&h.includes(e.tagName.toLowerCase()))continue;let r=o.startsWith("@")?o.slice(1):o;p.includes(r)&&l(i)?g(t,r):o.startsWith("on")?d(t,o,i,n):v(t,r,i)}for(let{name:e,value:n}of o)r[e]||m.includes(e)&&h.includes(t.tagName.toLowerCase())||g(t,e)}(e,o[r],n),!e.childNodes.length&&o[r].childNodes.length)return f(e.children,n),void(o[r].innerHTML="");if(!o[r].childNodes.length&&e.childNodes.length){let t=document.createDocumentFragment();return w(e,t,n),void o[r].appendChild(t)}e.childNodes.length&&w(e,o[r],n)})),function(e,t,n){let r=e.length-t.length;if(!(r<1))for(;r>0;r--)f([e[e.length-1]],n),e[e.length-1].remove()}(o,r,n))}function x(e,i={}){let{data:l,store:c,template:a,isStore:s,setters:d,listeners:f,after:h}=i;if(!e&&!s)return t("Element not found.");if(!a&&!s)return t("Please provide a template function.");let m=d?r(l):u(l,this);Object.defineProperties(this,{_store:{value:c},_template:{value:a},_debounce:{value:!1,writable:!0},_isStore:{value:s},_components:s?{value:[],writable:!0}:{value:null},_listeners:{value:Object.freeze(f)},elem:{get:function(){return"string"==typeof e?document.querySelector(e):e}},data:{get:function(){return d?r(m):m},set:function(e){return d||(m=u(e,this),o(this)),!0},configurable:!0},dataCopy:{get:function(){return r(m)}},do:{value:function(e,...n){return d?d[e]?(d[e].apply(this,[m,...n]),m=r(m),void o(this)):t(`No setter named "${e}".`):t("No setters for this component.")}}}),c&&c._components.push(this),n("initialize",this)}return x.prototype.html=function(){return i(this).template},x.prototype.render=function(){if(this._isStore){for(let e of this._components)"render"in e&&"function"==typeof e.render&&e.render();return}let e=i(this);return e.elem?n("before-render",{data:e.data,component:this},e.elem)?(w(function(e){let t=(new DOMParser).parseFromString(e,"text/html");return t.head&&t.head.childNodes&&t.head.childNodes.length>0&&Array.from(t.head.childNodes).reverse().forEach((function(e){t.body.insertBefore(e,t.body.firstChild)})),t.body||document.createElement("body")}(e.template),e.elem,this),n("render",{data:e.data,component:this},e.elem),e.elem):void 0:t("Render target not found.")},x.Store=function(e){return e.isStore=!0,new x(null,e)},x.debug=function(t){e=!!t},n("ready"),x}();
