/*! reef v11.0.0BETA | (c) 2021 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */
var reef=function(e){"use strict";function t(e){return(new DOMParser).parseFromString(e,"text/html").body||document.createElement("body")}function n(e,n){function o(e,t){let n=t.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!n.includes("javascript:")&&!n.includes("data:"))||(!!e.startsWith("on")||void 0)}function r(e){let t=e.attributes;for(let{name:n,value:r}of t)o(n,r)&&e.removeAttribute(n)}let i=t(e);return function(e){let t=e.querySelectorAll("script");for(let e of t)e.remove()}(i),function e(t){let n=t.children;for(let t of n)r(t),e(t)}(i),n?i:i.innerHTML}function o(e){return["false","null","undefined","0","-0","NaN","0n","-0n"].includes(e)}function r(e){let t;return function(){let n=this,o=arguments;t&&window.cancelAnimationFrame(t),t=window.requestAnimationFrame((function(){e.apply(n,o)}))}}function i(e){return e.props.map((function(e){return e.data}))}function u(e){for(let t of e.fns)t.run()}function f(e,t){return"object"==typeof e&&(e=new Proxy(e,function e(t){return{get:function(n,o){return"object"==typeof n[o]?new Proxy(n[o],e(t)):n[o]},set:function(e,n,o){return e[n]===o||(e[n]=o,u(t)),!0},deleteProperty:function(e,n){return delete e[n],u(t),!0}}}(t))),e}function l(e){e=f(e,this),this._debounce=null,Object.defineProperties(this,{data:{get:function(){return e},set:function(t){return e=f(t,this),u(this),!0}},fns:{value:[]}})}function c(e,t){Object.defineProperties(this,{el:{value:"string"==typeof e?document.querySelector(e):e},fn:{value:t},props:{value:[]}}),console.log(this.el)}function s(e,t){function n(e,t){c.call(this,e,t)}return n.prototype=Object.create(c.prototype),n}l.prototype.do=function(...e){for(let t of e)this.fns.includes(t)||(this.fns.push(t),t.add(this))},l.prototype.stop=function(...e){for(let t of e){let e=this.fns.indexOf(t);if(e<0)return;this.fns.splice(e,1),t.rm(this)}},l.prototype.run=function(){u(this)},c.prototype.add=function(e){this.props.push(e)},c.prototype.rm=function(e){let t=this.props.indexOf(e);t<0||this.props.splice(t,1)};let d=s();d.prototype.run=r((function(){this.el.textContent=this.fn(...i(this))}));let a=s();a.prototype.run=r((function(){elem.innerHTML=n(fn(...i(this)))})),s().prototype.run=r((function(){elem.innerHTML=fn(...i(this))}));let p=["input","option","textarea"],h=["value","checked","selected"],m=["checked","selected"];function y(e,t,n){h.includes(t)&&(e[t]="value"===t?n:" "),e.setAttribute(t,n)}function g(e,t){h.includes(t)&&(e[t]=""),e.removeAttribute(t)}function v(e){if(1===e.nodeType){for(let{name:t,value:n}of e.attributes){if("reef-"!==t.slice(0,5))continue;let r=t.replace("reef-default-","").replace("reef-","");g(e,t),m.includes(r)&&o(n)||y(e,r,n)}if(e.childNodes)for(let t of e.childNodes)v(t)}}function N(e){return e.childNodes&&e.childNodes.length?null:e.textContent}function b(e,t){return e.nodeType!==t.nodeType||e.tagName!==t.tagName||e.id!==t.id||e.src!==t.src}function w(e,t){let n=e.childNodes,r=t.childNodes;n.forEach((function(e,n){if(!r[n])return v(e),void t.append(e.cloneNode(!0));if(b(e,r[n])){let t=function(e,t,n){return Array.from(t).slice(n+1).find((function(t){return!b(e,t)}))}(e,r,n);if(!t)return v(e),void r[n].before(e.cloneNode(!0));r[n].before(t)}let i=N(e);if(i&&i!==N(r[n])&&(r[n].textContent=i),function(e,t){if(1!==e.nodeType)return;let n=e.attributes,r=t.attributes;for(let{name:r,value:i}of n){if("reef-default-"===r.slice(0,13))continue;if(h.includes(r)&&p.includes(e.tagName.toLowerCase()))continue;let n=r.replace("reef-","");m.includes(n)&&o(i)?g(t,n):y(t,n,i)}for(let{name:e,value:o}of r)n[e]||h.includes(e)&&p.includes(t.tagName.toLowerCase())||g(t,e)}(e,r[n]),e.childNodes.length||!r[n].childNodes.length){if(!r[n].childNodes.length&&e.childNodes.length){let t=document.createDocumentFragment();return w(e,t),void r[n].appendChild(t)}e.childNodes.length&&w(e,r[n])}else r[n].innerHTML=""})),function(e,t){let n=e.length-t.length;if(!(n<1))for(;n>0;n--)e[e.length-1].remove()}(r,n)}let x=s();x.prototype.run=r((function(){w(n(fn(...i(this)),!0),elem)}));let T=s();return T.prototype.run=r((function(){w(t(fn(...i(this))),elem)})),e.Store=l,e.diff=function(e,t){return new x(e,t)},e.diffUnsafe=function(e,t){return new T(e,t)},e.html=function(e,t){return new a(e,t)},e.htmlUnsafe=function e(t,n){return new e(t,n)},e.text=function(e,t){return new d(e,t)},e}({});
