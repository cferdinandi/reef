/*! reef v12.3.1 | (c) 2023 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */
var reef=function(e){"use strict";function t(e,t,n=document){let r=new CustomEvent(`reef:${e}`,{bubbles:!0,cancelable:!0,detail:t});return n.dispatchEvent(r)}function n(e){return"string"==typeof e?document.querySelector(e):e}function r(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function i(e,n){let s="store"+(e?`-${e}`:"");return{get:(t,s)=>"_isProxy"===s||(["object","array"].includes(r(t[s]))&&!t[s]._isProxy&&(t[s]=new Proxy(t[s],i(e,n))),t[s]),set:(e,r,i)=>(e[r]===i||(e[r]=i,t(s,n)),!0),deleteProperty:(e,r)=>(delete e[r],t(s,n),!0)}}class s{constructor(e,n,r=""){let i="store"+(r?`-${r}`:"");Object.defineProperties(this,{data:{get:()=>structuredClone(e),set:()=>!0}});for(let r in n)"function"==typeof n[r]&&(this[r]=function(...s){n[r](e,...s),t(i,e)})}}let o=["input","option","textarea"],l=["value","checked","selected"],c=["checked","selected"];function d(e){return["false","null","undefined","0","-0","NaN","0n","-0n"].includes(e)}function u(e,t,n){let r=t.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!r.includes("javascript:")&&!r.includes("data:text/html"))||(!(!e.startsWith("@on")&&!e.startsWith("#on"))||(!(n||!e.startsWith("on"))||void 0))}function a(e,t,n,r){u(t,n,r)||(r&&r.delegate?r.delegate(e,t,n):(l.includes(t)&&(e[t]="value"===t?n:" "),e.setAttribute(t,n)))}function f(e,t){l.includes(t)&&(e[t]=""),e.removeAttribute(t)}function h(e,t){if(1===e.nodeType){for(let{name:n,value:r}of e.attributes){if(u(n,r,t)){f(e,n);continue}if(t&&t.delegate){t.delegate(e,n,r),f(e,n);continue}if(!n.startsWith("@")&&!n.startsWith("#"))continue;let i=n.slice(1);f(e,n),c.includes(i)&&d(r)||a(e,i,r,t)}if(e.childNodes)for(let n of e.childNodes)h(n,t)}}function m(e){return e.childNodes&&e.childNodes.length?null:e.textContent}function p(e,t){return"number"==typeof e.nodeType&&e.nodeType!==t.nodeType||"string"==typeof e.tagName&&e.tagName!==t.tagName||"string"==typeof e.id&&e.id!==t.id||"string"==typeof e.src&&e.src!==t.src}function g(e,t,n){let r=e.childNodes,i=t.childNodes;(function(e){let t=e.querySelectorAll("script");for(let e of t)e.remove()})(e)||(r.forEach((function(e,r){if(!i[r]){let r=e.cloneNode(!0);return h(r,n),void t.append(r)}if(p(e,i[r])){let t=function(e,t,n){return Array.from(t).slice(n+1).find((function(t){return!p(e,t)}))}(e,i,r);if(!t){let t=e.cloneNode(!0);return h(t,n),void i[r].before(t)}i[r].before(t)}if(function(e,t,n){if(1!==e.nodeType)return;let r=e.attributes,i=t.attributes;for(let{name:i,value:s}of r){if(i.startsWith("#"))continue;if(l.includes(i)&&o.includes(e.tagName.toLowerCase()))continue;let r=i.startsWith("@")?i.slice(1):i;c.includes(r)&&d(s)?f(t,r):a(t,r,s,n)}for(let{name:e,value:n}of i)r[e]||e.startsWith("reef-on")&&r[e.replace("reef-","")]||l.includes(e)&&o.includes(t.tagName.toLowerCase())||f(t,e)}(e,i[r],n),e.nodeName.includes("-"))return;let s=m(e);if(s&&s!==m(i[r])&&(i[r].textContent=s),e.childNodes.length||!i[r].childNodes.length){if(!i[r].childNodes.length&&e.childNodes.length){let t=document.createDocumentFragment();return g(e,t,n),void i[r].appendChild(t)}e.childNodes.length&&g(e,i[r],n)}else i[r].innerHTML=""})),function(e,t){let n=e.length-t.length;if(!(n<1))for(;n>0;n--)e[e.length-1].remove()}(i,r))}function v(e,r,i){let s=n(e),o=function(e){let t=(new DOMParser).parseFromString(e,"text/html");return t.head&&t.head.childNodes.length&&Array.from(t.head.childNodes).reverse().forEach((function(e){t.body.insertBefore(e,t.body.firstChild)})),t.body||document.createElement("body")}(r);t("before-render",null,s)&&(g(o,s,i),t("render",null,s))}class y{constructor(e,t,n){var r;this.elem=e,this.template=t,this.stores=n.stores?n.stores.map((e=>`reef:store-${e}`)):["reef:store"],this.events=n.events,this.handler=(r=this,function(e){r.render()}),this.debounce=null,this.start()}start(){for(let e of this.stores)document.addEventListener(e,this.handler);this.render(),t("start",null,n(this.elem))}stop(){for(let e of this.stores)document.removeEventListener(e,this.handler);t("stop",null,n(this.elem))}render(){let e=this;e.debounce&&window.cancelAnimationFrame(e.debounce),e.debounce=window.requestAnimationFrame((function(){v(e.elem,e.template(),e.events)}))}}class b{#e;#t;#n;constructor(e){this.#e={},this.#t={},this.#n=[];for(let[t,n]of Object.entries(e)){let e=crypto.randomUUID();this.#e[t]={fn:n,id:e},this.#t[e]=t}}static getHandler(e){return function(t){let n=t.target.closest(`[reef-on${t.type}]`);if(!n)return;let r=e.#t[n.getAttribute(`reef-on${t.type}`)];e.#n.includes(t.type)&&e.#e[r]&&e.#e[r].fn(t)}}delegate(e,t,n){let r=n.split("(")[0],i=this.#e[r];if(!i)return;e.setAttribute(`reef-${t}`,i.id);let s=t.replace("on","");this.#n.includes(s)||(document.addEventListener(s,b.getHandler(this),!0),this.#n.push(s))}}return e.component=function(e,t,n={}){return new y(e,t,n)},e.listeners=function(e){return new b(e)},e.render=v,e.setter=function(e={},t={},n=""){return new s(e,t,n)},e.store=function(e={},t=""){return e=["array","object"].includes(r(e))?e:{value:e},new Proxy(e,i(t,e))},e}({});
//# sourceMappingURL=reef.min.js.map
