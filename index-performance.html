<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Test</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<style type="text/css">
		body {
			margin: 0 auto;
			max-width: 40em;
			width: 88%;
		}
	</style>
</head>
<body>

	<div id="app"></div>
	<button id="swapWizardsButton" type="button">Swap Wizards</button>

	<script src="dist/reef.js"></script>
	<script>
		// Turn on debug mode
		Reef.debug(true);

		// Create a wizards component
		let app = new Reef('#app', {
			data: {
				heading: 'Magical Folk Rankings',
				wizards: {
					heading: 'Best Wizard',
					rankings: [
						{name: 'Gandalf', uniform: 'white', votes: 5},
						{name: 'Radagast', uniform: 'brown', votes: 4},
						{name: 'Merlin', uniform: 'blue', votes: 1}
					]
				},
				witches: {
					heading: 'Scariest Witch',
					rankings: [
						{name: 'Wicked Witch', uniform: 'black', votes: 5},
						{name: 'Ursula', uniform: 'purple', votes: 3},
						{name: 'Blair Witch', uniform: 'darkblue', votes: 2}
					]
				}
			},
			template: function (props) {
				let html = '';

				// create heading
				html += `<h1>${props.heading}</h1>`;

				let groups = Object.keys(props);

				let wizards = props.wizards.rankings;
				let num = wizards.length;
				html += `<h2>${props.wizards.heading}</h2>`;

				// If there are no wizards, show a message
				if (!num) {
					html += `<p>There aren't any wizards yet.</p>`;
				} else {
					// build wizards list
					html += `
						<ol>
							${wizards.map(function (person) {
								//console.log('person',person);
								return `<li>${person.name} <span style="background:${person.uniform}" class="shirt"></span> &ndash; ${person.votes} votes</li>`;
							}).join('')}
						</ol>
					`;
				}

				let witches = props.witches.rankings;
				num = witches.length;
				html += `<h2>${props.witches.heading}</h2>`;

				if (!num) {
					html += `<p>There aren't any witches yet.</p>`;
				} else {
					// build wizards list
					html += `
						<ol>
							${witches.map(function (person) {
								//console.log('person',person);
								return `<li>${person.name} <span style="background:${person.uniform}" class="shirt"></span> &ndash; ${person.votes} votes</li>`;
							}).join('')}
						</ol>
					`;
				}

				return html;
			},
			setters: {
				swapWizards: function (props, pos1,pos2) {
					let item1 = props.wizards.rankings[pos1];
					props.wizards.rankings[pos1] = props.wizards.rankings[pos2];
					props.wizards.rankings[pos2] = item1;
					console.log(props.wizards.rankings);
				}
			},
			after: {
				render: function (props) {
					console.log('rendered', props);
					document.title = props.wizards.rankings[0].name;
				}
			}
		});

		let button = document.querySelector('#swapWizardsButton');
		button.addEventListener('click',function(e){
			app.do('swapWizards', 0, 1);
		});

		// Render the UI
		app.render();
	</script>

</body>
</html>